#!/usr/bin/env bash

build_file="-f build/build.xml"
if [ "$(basename $(pwd))" == "build" ]; then
  build_file=""
fi

ant_command="ant $1 $2 $3 $4 $5 $6 $7 $8 $9"
time=$(date +%H:%M)
lemonbar-show "($time) Running: $ant_command" --fg "#FFFF00"

ant $build_file $1 $2 $3 $4 $5 $6

result=$?

time=$(date +%H:%M)
if [ "$result" == "0" ]; then
  notify "Build successful!" "$ant_command"
  lemonbar-show "($time) Success: $ant_command" --fg "#99FF99"
else
  notify-send "Build failure!" "$ant_command"
  lemonbar-show "($time) Failed: $ant_command" --fg "#C45454"
fi

exit $result
